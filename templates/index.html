
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Code Runner - Pyodide</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .editor-section {
            margin-bottom: 20px;
        }
        #code-editor {
            width: 100%;
            height: 300px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
        }
        .button-group {
            margin: 20px 0;
            text-align: center;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .output-section {
            margin-top: 20px;
        }
        #output {
            background-color: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            min-height: 200px;
            white-space: pre-wrap;
            overflow-y: auto;
        }
        #plot-container {
            text-align: center;
            margin-top: 20px;
        }
        #plot-container img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .loading {
            color: #007bff;
            font-style: italic;
        }
        .examples {
            margin-top: 20px;
        }
        .example-button {
            background-color: #28a745;
            margin: 5px;
            padding: 8px 15px;
            font-size: 14px;
        }
        .example-button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üêç Python Code Runner with Pyodide</h1>
        
        <div class="editor-section">
            <h3>Python Code Editor:</h3>
            <textarea id="code-editor" placeholder="# Write your Python code here...
import matplotlib.pyplot as plt
import numpy as np

# Example: Simple plot
x = np.linspace(0, 10, 100)
y = np.sin(x)
plt.figure(figsize=(8, 6))
plt.plot(x, y, 'b-', linewidth=2)
plt.title('Sine Wave')
plt.xlabel('X axis')
plt.ylabel('Y axis')
plt.grid(True)
plt.show()"></textarea>
        </div>

        <div class="button-group">
            <button onclick="runCode()" id="run-btn">‚ñ∂Ô∏è Run Code</button>
            <button onclick="clearOutput()">üóëÔ∏è Clear Output</button>
            <button onclick="clearCode()">üìù Clear Code</button>
        </div>

        <div class="examples">
            <h3>Example Codes:</h3>
            <button class="example-button" onclick="loadExample('basic')">Basic Python</button>
            <button class="example-button" onclick="loadExample('matplotlib')">Matplotlib Graph</button>
            <button class="example-button" onclick="loadExample('numpy')">NumPy Array</button>
            <button class="example-button" onclick="loadExample('pandas')">Pandas DataFrame</button>
        </div>

        <div class="output-section">
            <h3>Output:</h3>
            <div id="output"></div>
            <div id="plot-container"></div>
        </div>
    </div>

    <script>
        let pyodide;
        let isLoading = false;

        // Pyodide initialize karte hain
        async function initializePyodide() {
            if (pyodide) return;
            
            document.getElementById('output').textContent = 'Loading Pyodide... Please wait...';
            
            try {
                pyodide = await loadPyodide();
                
                // Required packages install karte hain
                await pyodide.loadPackage(["numpy", "matplotlib", "pandas"]);
                
                // Matplotlib ko web ke liye configure karte hain
                await pyodide.runPython(`
import matplotlib
matplotlib.use('agg')
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import io
import base64

def show_plot():
    buf = io.BytesIO()
    plt.savefig(buf, format='png', dpi=150, bbox_inches='tight')
    buf.seek(0)
    img_data = base64.b64encode(buf.read()).decode()
    buf.close()
    plt.close()
    return img_data
                `);
                
                document.getElementById('output').textContent = 'Pyodide loaded successfully! Ready to run Python code.';
            } catch (error) {
                document.getElementById('output').textContent = 'Error loading Pyodide: ' + error;
            }
        }

        // Page load hone par Pyodide initialize karte hain
        window.onload = function() {
            initializePyodide();
        };

        // Code run karne ka function
        async function runCode() {
            if (isLoading) return;
            
            const code = document.getElementById('code-editor').value;
            const outputDiv = document.getElementById('output');
            const plotContainer = document.getElementById('plot-container');
            const runBtn = document.getElementById('run-btn');
            
            if (!code.trim()) {
                outputDiv.textContent = 'Please enter some Python code to run.';
                return;
            }

            if (!pyodide) {
                outputDiv.textContent = 'Pyodide is still loading... Please wait.';
                return;
            }

            isLoading = true;
            runBtn.disabled = true;
            runBtn.textContent = '‚è≥ Running...';
            outputDiv.textContent = 'Executing code...\n';
            plotContainer.innerHTML = '';

            try {
                // Output capture karne ke liye
                await pyodide.runPython(`
import sys
from io import StringIO
sys.stdout = StringIO()
sys.stderr = StringIO()
                `);

                // User ka code run karte hain
                await pyodide.runPython(code);

                // Output capture karte hain
                const stdout = await pyodide.runPython("sys.stdout.getvalue()");
                const stderr = await pyodide.runPython("sys.stderr.getvalue()");

                // Check if matplotlib plot was created
                let hasPlot = false;
                try {
                    const plotCheck = await pyodide.runPython(`
plt.get_fignums() if 'plt' in globals() else []
                    `);
                    hasPlot = plotCheck.length > 0;
                } catch (e) {
                    // No matplotlib usage
                }

                // Output display karte hain
                let output = '';
                if (stdout) output += stdout;
                if (stderr) output += 'Errors:\n' + stderr;
                if (!output && !hasPlot) output = 'Code executed successfully (no output)';

                outputDiv.textContent = output;

                // Agar plot hai to display karte hain
                if (hasPlot) {
                    try {
                        const imgData = await pyodide.runPython('show_plot()');
                        const img = document.createElement('img');
                        img.src = 'data:image/png;base64,' + imgData;
                        img.alt = 'Generated Plot';
                        plotContainer.appendChild(img);
                    } catch (plotError) {
                        outputDiv.textContent += '\nError displaying plot: ' + plotError;
                    }
                }

            } catch (error) {
                outputDiv.textContent = 'Error: ' + error.toString();
            } finally {
                // Reset stdout/stderr
                await pyodide.runPython(`
import sys
sys.stdout = sys.__stdout__
sys.stderr = sys.__stderr__
                `);
                isLoading = false;
                runBtn.disabled = false;
                runBtn.textContent = '‚ñ∂Ô∏è Run Code';
            }
        }

        function clearOutput() {
            document.getElementById('output').textContent = '';
            document.getElementById('plot-container').innerHTML = '';
        }

        function clearCode() {
            document.getElementById('code-editor').value = '';
        }

        function loadExample(type) {
            const editor = document.getElementById('code-editor');
            
            const examples = {
                'basic': `# Basic Python Example
print("Hello from Pyodide!")
print("Python version:", __import__('sys').version)

# Simple calculations
numbers = [1, 2, 3, 4, 5]
print("Numbers:", numbers)
print("Sum:", sum(numbers))
print("Average:", sum(numbers) / len(numbers))

# String operations
text = "Python is awesome!"
print("Text:", text)
print("Uppercase:", text.upper())
print("Word count:", len(text.split()))`,

                'matplotlib': `# Matplotlib Graph Example
import matplotlib.pyplot as plt
import numpy as np

# Create sample data
x = np.linspace(0, 2*np.pi, 100)
y1 = np.sin(x)
y2 = np.cos(x)

# Create the plot
plt.figure(figsize=(10, 6))
plt.plot(x, y1, 'b-', label='sin(x)', linewidth=2)
plt.plot(x, y2, 'r--', label='cos(x)', linewidth=2)

plt.title('Sine and Cosine Functions', fontsize=16)
plt.xlabel('X (radians)', fontsize=12)
plt.ylabel('Y', fontsize=12)
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()

plt.show()
print("Graph generated successfully!")`,

                'numpy': `# NumPy Array Operations
import numpy as np

# Create arrays
arr1 = np.array([1, 2, 3, 4, 5])
arr2 = np.array([6, 7, 8, 9, 10])

print("Array 1:", arr1)
print("Array 2:", arr2)
print("Sum:", arr1 + arr2)
print("Product:", arr1 * arr2)
print("Dot product:", np.dot(arr1, arr2))

# 2D array operations
matrix = np.random.random((3, 3))
print("\\nRandom 3x3 matrix:")
print(matrix)
print("Matrix transpose:")
print(matrix.T)
print("Matrix determinant:", np.linalg.det(matrix))`,

                'pandas': `# Pandas DataFrame Example
import pandas as pd
import numpy as np

# Create sample data
data = {
    'Name': ['Alice', 'Bob', 'Charlie', 'Diana', 'Eve'],
    'Age': [25, 30, 35, 28, 32],
    'City': ['New York', 'London', 'Tokyo', 'Paris', 'Sydney'],
    'Salary': [50000, 60000, 75000, 55000, 65000]
}

# Create DataFrame
df = pd.DataFrame(data)

print("DataFrame:")
print(df)
print("\\nDataFrame Info:")
print(df.info())
print("\\nStatistical Summary:")
print(df.describe())
print("\\nAverage Age:", df['Age'].mean())
print("Highest Salary:", df['Salary'].max())`
            };

            editor.value = examples[type] || '';
        }

        // Enter key se code run karne ke liye (Ctrl+Enter)
        document.getElementById('code-editor').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                runCode();
            }
        });
    </script>
</body>
</html>
